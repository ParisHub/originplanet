Local Helper Bridge API Contract
================================

Purpose
-------
Defines the current lightweight contract between:
1) Frontend app (`index.html` + `app.js`)
2) Local Windows worker (`local-worker.hta`)

Current execution mode
----------------------
Primary mode now is direct HTA launch with an encoded request in query string:

mshta.exe "<absolute_path_to_local-worker.hta>?request=<urlencoded-json>"

If launch is unavailable (for example, a standard browser blocks ActiveXObject),
frontend falls back to a local simulated response only for development visibility.

Current Envelope
----------------
The frontend prepares this JSON request envelope:

{
  "version": "1.0",
  "source": "local-helper-bridge-ui",
  "timestamp": "2026-01-01T12:00:00.000Z",
  "task": {
    "type": "open-path | run-command | show-toast",
    "payload": "string",
    "priority": 1..5
  }
}

Validation Rules (frontend)
---------------------------
- payload: required
- payload length: <= 260 chars (safe early limit for Windows path/command ergonomics)

Startup behavior (HTA)
----------------------
- On load, HTA reads query parameter `request`.
- If present, HTA executes request immediately.
- If absent, HTA waits for manual demo button interaction.

Expected HTA Response
---------------------
{
  "accepted": true,
  "status": "queued | running | complete | failed",
  "requestId": "hex-string",
  "error": "optional error text"
}

Task Semantics (current and planned)
------------------------------------
- show-toast + payload "hello": immediately opens a small hello popup window in HTA.
- open-path: planned (open file/folder in Explorer)
- run-command: planned (execute trusted command with controlled allowlist)

Security Notes
--------------
- Never execute untrusted payload directly.
- Add allowlist + argument sanitization before enabling run-command.
- Consider explicit confirmation UI for destructive actions.

Versioning
----------
- `version` in request is mandatory.
- Breaking change => increment major version and keep compatibility adapter in HTA.
